<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>AI Agent</title>

  <style>
    body {
      margin: 0;
      height: 100vh;
      background: radial-gradient(circle at top, #1e1e2f, #0f0f14);
      display: flex;
      align-items: center;
      justify-content: center;
      font-family: Arial, sans-serif;
      color: #fff;
    }

    .agent-box {
      width: 420px;
      background: #111827;
      border-radius: 14px;
      padding: 20px;
      box-shadow: 0 0 40px rgba(0,0,0,0.6);
    }

    textarea {
      width: 100%;
      height: 80px;
      border-radius: 8px;
      border: none;
      padding: 10px;
      font-size: 14px;
      resize: none;
    }

    button {
      width: 100%;
      margin-top: 12px;
      padding: 12px;
      border-radius: 10px;
      border: none;
      font-size: 15px;
      cursor: pointer;
      background: #2563eb;
      color: white;
    }

    button:disabled {
      background: #374151;
      cursor: not-allowed;
    }

    #status {
      margin-top: 10px;
      font-size: 13px;
      color: #9ca3af;
    }

    pre {
      margin-top: 12px;
      background: #020617;
      padding: 10px;
      border-radius: 8px;
      max-height: 250px;
      overflow-y: auto;
      font-size: 13px;
    }
  </style>
</head>

<body>

<div class="agent-box">
  <h3>ü§ñ AI Agent</h3>

  <textarea id="prompt">Enter your Goal here</textarea>

  <button id="runBtn">Run Agent</button>

  <div id="status"></div>

  <pre id="output"></pre>
</div>

<script>
/* ================= CONFIG ================= */
const MODEL = "mistralai/mistral-7b-instruct:free";
const MAX_STEPS = 3;

/* ================= STATE ================= */
let isRunning = false;

/* ================= ELEMENTS ================= */
const runBtn = document.getElementById("runBtn");
const statusEl = document.getElementById("status");
const outputEl = document.getElementById("output");

/* ================= API CALL ================= */
async function callLLM(prompt) {
  const res = await fetch("https://openrouter.ai/api/v1/chat/completions", {
    method: "POST",
    headers: {
      "Authorization": `Bearer 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`,
      "Content-Type": "application/json"
    },
    body: JSON.stringify({
      model: MODEL,
      messages: [{role:"system",content:"You are the Ai agent  and extract the latest data based on the prompt"
        
      },{ role: "user", content: prompt }]
    })
  });

  const data = await res.json();
  console.log("API RESPONSE:", data);
  return data.choices[0].message.content;
}

/* ================= AGENT ================= */
async function runAgent() {
  if (isRunning) return; 
  isRunning = true;

  runBtn.disabled = true;
  outputEl.textContent = "";
  statusEl.textContent = "‚öôÔ∏è Agent started...";

  const userPrompt = document.getElementById("prompt").value;

  try {
    for (let step = 1; step <= MAX_STEPS; step++) {
      statusEl.textContent = `üß† Step ${step} / ${MAX_STEPS}`;

      const response = await callLLM(
        `Step ${step}: ${userPrompt}`
      );

      outputEl.textContent += `\n\n--- Step ${step} ---\n${response}`;

      // ‚úÖ optional early stop
      if (response.toLowerCase().includes("completed")) {
        break;
      }
    }

    statusEl.textContent = "‚úÖ Agent finished";
  } catch (err) {
    console.error(err);
    statusEl.textContent = "‚ùå Error occurred";
  }

  isRunning = false;
  runBtn.disabled = false;
}

/* ================= EVENT ================= */
runBtn.addEventListener("click", runAgent);
</script>

</body>
</html>
